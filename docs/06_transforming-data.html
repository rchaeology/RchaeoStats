<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDA: Transforming data with tidyverse – RchaeoStats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../docs/08_communicating-results.html" rel="next">
<link href="../docs/05_visualising-data.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8a4037d18cce27f819308f361db56754.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Materials</li><li class="breadcrumb-item"><a href="../docs/06_transforming-data.html">06 - Transforming Data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/hexsticker.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Core</span></span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/00_install-r-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/01_r-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 - R Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/02_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 - An Example Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/03_rstudio-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 - Getting Organised</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/04_cleaning-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 - Cleaning Data</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">EDA</span></span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/05_visualising-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 - Visualising Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/06_transforming-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">06 - Transforming Data</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Extensions</span></span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/08_communicating-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08 - Communicating Results</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/content/00_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00 - Welcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/content/01_rstudio-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 - RStudio Projects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/content/02_stats-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 - Stats Basics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#subsetting-data" id="toc-subsetting-data" class="nav-link active" data-scroll-target="#subsetting-data">Subsetting data</a></li>
  <li><a href="#groups" id="toc-groups" class="nav-link" data-scroll-target="#groups">Groups</a></li>
  <li><a href="#summarise" id="toc-summarise" class="nav-link" data-scroll-target="#summarise">summarise()</a></li>
  <li><a href="#across" id="toc-across" class="nav-link" data-scroll-target="#across">across()</a></li>
  <li><a href="#selection-helpers" id="toc-selection-helpers" class="nav-link" data-scroll-target="#selection-helpers">Selection helpers</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">Tidy data</a></li>
  <li><a href="#pivoting" id="toc-pivoting" class="nav-link" data-scroll-target="#pivoting">Pivoting</a>
  <ul class="collapse">
  <li><a href="#pivot_longer" id="toc-pivot_longer" class="nav-link" data-scroll-target="#pivot_longer"><code>pivot_longer()</code></a></li>
  <li><a href="#pivot_wider" id="toc-pivot_wider" class="nav-link" data-scroll-target="#pivot_wider"><code>pivot_wider()</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Materials</li><li class="breadcrumb-item"><a href="../docs/06_transforming-data.html">06 - Transforming Data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">EDA: Transforming data with tidyverse</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisites
</div>
</div>
<div class="callout-body-container callout-body">
<section id="knowledge" class="level3">
<h3 class="anchored" data-anchor-id="knowledge">Knowledge</h3>
<p>Core + Visualising data</p>
</section>
<section id="objects" class="level3">
<h3 class="anchored" data-anchor-id="objects">Objects</h3>
<p>Project organisation + Data cleaning</p>
</section>
</div>
</div>
<p>Sometimes cleaning our data is not enough, and we need to make further modifications. We can transform data using various functions from <span class="pkg">dplyr</span>.</p>
<p>Again, let’s start a new script and call it <em>02_data-transform.R</em>, saved to <em>scripts/</em>, and load <strong>tidyverse</strong> and <span class="pkg">here</span>, and the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/mortuary_clean.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="subsetting-data" class="level2">
<h2 class="anchored" data-anchor-id="subsetting-data">Subsetting data</h2>
<p>The two main functions for subsetting data are <code>select()</code> and <code>filter()</code>.</p>
<p><code>select()</code> allows us to select columns (yes, they nailed the name).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by name</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(mortuary_data, Golden_bead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 1
   Golden_bead
         &lt;dbl&gt;
 1          NA
 2          NA
 3          NA
 4           5
 5           2
 6           2
 7          NA
 8           2
 9          NA
10           2
# ℹ 115 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple names</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(mortuary_data, Golden_bead, Glass_bead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 2
   Golden_bead Glass_bead
         &lt;dbl&gt;      &lt;dbl&gt;
 1          NA         NA
 2          NA         NA
 3          NA         NA
 4           5         NA
 5           2         NA
 6           2         NA
 7          NA          1
 8           2          1
 9          NA         NA
10           2         NA
# ℹ 115 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or (as before) position</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(mortuary_data, <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">23</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 2
   Golden_bead Glass_bead
         &lt;dbl&gt;      &lt;dbl&gt;
 1          NA         NA
 2          NA         NA
 3          NA         NA
 4           5         NA
 5           2         NA
 6           2         NA
 7          NA          1
 8           2          1
 9          NA         NA
10           2         NA
# ℹ 115 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Function conflicts
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are many packages made for R, and only so many ways to name a function (with a name that makes sense…) When two packages have functions with the same name, this can create a conflict, since R will only be able to use one of the functions.</p>
<p>For example, if you have both <span class="pkg">dplyr</span> and the <span class="pkg">MASS</span> packages loaded, you will likely run into issues with the <code>select()</code> function, since both packages have a function by that name, but they serve different purposes and have different argument structures.</p>
<p>If R has decided to use the function from <span class="pkg">MASS</span>, running the code <code>select(clean_data, Glass_bead)</code> will result in an error: <code>Error in select(clean_data, Glass_bead) : unused argument (Glass_bead)</code></p>
<p>To resolve this you can specify the function namespace, <code>namespace::function()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(mortuary_data, Glass_bead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You are essentially telling R that you specifically want to use <code>select()</code> from {dplyr}.</p>
</div>
</div>
</div>
<p>You may have noted that there was no need to surround the name of the column in quotes (<code>"Glass_bead"</code>). This is a <strong>tidyverse</strong> thing that I won’t go into any further. This may not be possible to do in other packages, where you could encounter an error in the form of <code>object Glass_bead not found</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/cb8d9c50-f48e-4c6d-a5b3-1d30ce0be2ad_rw_1920.png?h=1a879eda58a5efbf709ad0a59d784f98" class="img-fluid figure-img" alt="Cartoon showing three fuzzy monsters either selecting or crossing out rows of a data table. If the type of animal in the table is “otter” and the site is “bay”, a monster is drawing a purple rectangle around the row. If those conditions are not met, another monster is putting a line through the column indicating it will be excluded. Stylized text reads “dplyr::filter() - keep rows that satisfy your conditions.” Learn more about dplyr::filter."></p>
<figcaption><a href="https://twitter.com/allison_horst">Artwork by <span class="citation" data-cites="allison_horst">@allison_horst</span>.</a></figcaption>
</figure>
</div>
<p><code>filter()</code> allows you to filter entries/rows based on certain conditions. If we wanted to only show the data that are associated with graves prior European arrival (<code>Phase == "pre"</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, Phase <span class="sc">==</span> <span class="st">"pre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 29 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 0               1         290         3    115    70     NA P9   
 2     1 6               1         310         3     85    55     13 P038 
 3     1 8               1         295         2    100    58     15 P038 
 4     1 12              2          NA         3     NA    NA      9 P038 
 5     1 21              1         290         2    105    47     22 P050 
 6     1 25              1         295         1     95    45     37 P061 
 7     1 27              1         315         3    115    80     20 P047 
 8     1 28              1         305         2    105    45     28 P058 
 9     1 32              1         305         1    140    58     50 P071 
10     1 34              1         305         2    102    60     45 P018 
# ℹ 19 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
</div>
<p>We can also filter by numeric values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, start_layer <span class="sc">==</span> <span class="dv">5</span>) <span class="co"># only values that are equal to 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 55
  Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
1     1 0               1         290         3    115    70     NA P9   
2     1 8               1         295         2    100    58     15 P038 
3     1 12              2          NA         3     NA    NA      9 P038 
4     1 40              1         280         1    100    55     20 P041 
5     1 81              1          15         1    140    70     60 P086 
6     1 83              2          NA         3     NA    NA     30 P117 
7     1 85              1         300         1    110    55     36 P083 
8     1 86              1         320         1     80    50     24 P082 
9     1 115             1         310         2    110    55     20 P144 
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;,
#   fish_shape_knit &lt;dbl&gt;, Metal_string &lt;dbl&gt;, Metal_piece &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, start_layer <span class="sc">!=</span> <span class="dv">5</span>) <span class="co"># only values that are NOT equal to 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 1               1         295         2    102    60     30 P051 
 2     1 2               1         290         2    104    75     60 P051 
 3     1 3               1         290         1    130    82     60 P050 
 4     1 4               1         300         2    140    73     30 P038 
 5     1 5               1         285         2     70    50     35 P050 
 6     1 6               1         310         3     85    55     13 P038 
 7     1 7               1         290         2    130    60     29 P028 
 8     1 9               1         300         1    130    70     60 P052 
 9     1 11              1         300         2     90    60     40 P060 
10     1 15              1         290         2     95    60     27 P040 
# ℹ 71 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, start_layer <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="co"># only values that are greater than 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 1               1         295         2    102    60     30 P051 
 2     1 2               1         290         2    104    75     60 P051 
 3     1 3               1         290         1    130    82     60 P050 
 4     1 5               1         285         2     70    50     35 P050 
 5     1 7               1         290         2    130    60     29 P028 
 6     1 9               1         300         1    130    70     60 P052 
 7     1 11              1         300         2     90    60     40 P060 
 8     1 15              1         290         2     95    60     27 P040 
 9     1 16              1         300         1     76    45     37 P072 
10     1 17              1         292         2    100    60     30 P028 
# ℹ 23 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, start_layer <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> start_layer <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="co"># only values that are greater than 5 AND (&amp;) less than, or equal to 12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 2               1         290         2    104    75     60 P051 
 2     1 3               1         290         1    130    82     60 P050 
 3     1 5               1         285         2     70    50     35 P050 
 4     1 7               1         290         2    130    60     29 P028 
 5     1 9               1         300         1    130    70     60 P052 
 6     1 11              1         300         2     90    60     40 P060 
 7     1 15              1         290         2     95    60     27 P040 
 8     1 16              1         300         1     76    45     37 P072 
 9     1 17              1         292         2    100    60     30 P028 
10     1 18              1         280         2    110    70     24 P061 
# ℹ 21 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mortuary_data, start_layer <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">|</span> start_layer <span class="sc">&lt;</span> <span class="dv">12</span>) <span class="co"># only values that are greater than 5 OR (|) less than 12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 0               1         290         3    115    70     NA P9   
 2     1 1               1         295         2    102    60     30 P051 
 3     1 2               1         290         2    104    75     60 P051 
 4     1 3               1         290         1    130    82     60 P050 
 5     1 4               1         300         2    140    73     30 P038 
 6     1 5               1         285         2     70    50     35 P050 
 7     1 6               1         310         3     85    55     13 P038 
 8     1 7               1         290         2    130    60     29 P028 
 9     1 8               1         295         2    100    58     15 P038 
10     1 9               1         300         1    130    70     60 P052 
# ℹ 80 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
</div>
<p>This could be combined with <code>select()</code> to only show the relevant columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="fu">filter</span>(mortuary_data, Phase <span class="sc">==</span> <span class="st">"pre"</span>), ID, Golden_bead, Small_Metal_ring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 29 × 3
   ID    Golden_bead Small_Metal_ring
   &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt;
 1 0              NA                1
 2 6              NA                2
 3 8              NA               NA
 4 12              2                1
 5 21              1                4
 6 25             NA                3
 7 27             NA                4
 8 28             NA                2
 9 32              6               NA
10 34              4               NA
# ℹ 19 more rows</code></pre>
</div>
</div>
<p>And now our code is very quickly becomming unreadable for humans… It’s good practice to break up code to avoid having too many nested functions. In the above case we only have one function inside <code>filter()</code>, but that function has quite a few arguments. It’s best to create multiple steps.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pre_euro <span class="ot">&lt;-</span> <span class="fu">filter</span>(mortuary_data, Phase <span class="sc">==</span> <span class="st">"pre"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(pre_euro, ID, Golden_bead, Small_Metal_ring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 29 × 3
   ID    Golden_bead Small_Metal_ring
   &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt;
 1 0              NA                1
 2 6              NA                2
 3 8              NA               NA
 4 12              2                1
 5 21              1                4
 6 25             NA                3
 7 27             NA                4
 8 28             NA                2
 9 32              6               NA
10 34              4               NA
# ℹ 19 more rows</code></pre>
</div>
</div>
<p>Filtering on multiple variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pre_euro_cond2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(mortuary_data, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                        Phase <span class="sc">==</span> <span class="st">"pre"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                        Condition <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>pre_euro_cond2_select <span class="ot">&lt;-</span> <span class="fu">select</span>(pre_euro_cond2, ID, Golden_bead, Small_Metal_ring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mean golden beads for Pit P061 with Condition 2 (partially disturbed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pre_euro_cond2_select<span class="sc">$</span>Golden_bead, <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pre_euro_cond2_select<span class="sc">$</span>Small_Metal_ring, <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.666667</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Missing data in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>You will often see the default setting for removing missing values as <code>FALSE</code>. This may seem strange. Why not just remove them by default for convenience? This is because of the R philosophy that no values should be silently removed. Either a function will not remove <code>NA</code>s, or it will give you a message informing you how many missing values/rows were removed.</p>
</div>
</div>
<p>If we wanted to also calculate the mean for the other conditions, we could repeat the above steps for <code>Condition == 1</code> and <code>Condition == 3</code>, but that would quickly get tedious. There is an easier way to calculate multiple means and other descriptive statistics using the <code>summarise()</code> and <code>group_by</code> functions from {dplyr}.</p>
</section>
<section id="groups" class="level2">
<h2 class="anchored" data-anchor-id="groups">Groups</h2>
<p>Groups allow you to calculate statistics and perform operations on groups within the data. For example, we could group the data by the <code>Phase</code> variable and then perform a calculation on each level of <code>Phase</code>. The function to group data is <code>group_by()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(<span class="at">.data =</span> mortuary_data, Phase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 55
# Groups:   Phase [6]
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 0               1         290         3    115    70     NA P9   
 2     1 1               1         295         2    102    60     30 P051 
 3     1 2               1         290         2    104    75     60 P051 
 4     1 3               1         290         1    130    82     60 P050 
 5     1 4               1         300         2    140    73     30 P038 
 6     1 5               1         285         2     70    50     35 P050 
 7     1 6               1         310         3     85    55     13 P038 
 8     1 7               1         290         2    130    60     29 P028 
 9     1 8               1         295         2    100    58     15 P038 
10     1 9               1         300         1    130    70     60 P052 
# ℹ 115 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
</div>
<p>As you can see above, <code>group_by()</code> doesn’t seem to make any changes to the data, but if you look closely under the dimensions of the tibble at the top of the tibble itself, we now have <code># Groups: Phase [6]</code>.</p>
<p>We can also see the <code>class()</code> of the tibble will be “grouped_df”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">group_by</span>(mortuary_data, Phase))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "grouped_df" "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
</section>
<section id="summarise" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="summarise">summarise()</h2>
<p><code>summarise()</code> (or <code>summarize()</code>) from <span class="pkg">dplyr</span> is a very useful way of getting a wide range of descriptive statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">.data =</span> mortuary_data,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_golden =</span> <span class="fu">mean</span>(Golden_bead, <span class="at">na.rm =</span> T)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_golden
        &lt;dbl&gt;
1        3.41</code></pre>
</div>
</div>
<p>Like <code>mutate()</code>, <code>summarise()</code> takes a <code>.data</code> argument first, and then name-value pairs for the new variable name and the function to compute the summary statistic(s). Unlike <code>mutate()</code>, the output of summarise is completely new data frame with one row per variable and one column per summary statistic. Above we created one column (<code>mean_golden</code>) and one row (the mean value of the <code>Golden_bead</code> variable).</p>
<p>We could also compute additional descriptives.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    mortuary_data,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_golden =</span> <span class="fu">mean</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_golden =</span> <span class="fu">median</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_golden =</span> <span class="fu">sd</span>(Golden_bead, <span class="at">na.rm =</span> T)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  mean_golden median_golden sd_golden
        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1        3.41             2      8.62</code></pre>
</div>
</div>
<p>Three name-value pairs equals three columns. To see how these descriptive statistics apply to different groups, such as the different phases of occupation in the <code>Phase</code> variable, we could use <code>group_by</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    mortuary_data,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_golden =</span> <span class="fu">mean</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_golden =</span> <span class="fu">median</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_golden =</span> <span class="fu">sd</span>(Golden_bead, <span class="at">na.rm =</span> T)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Phase'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 750 × 58
# Groups:   Phase [6]
   Phase Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 pre       1 0               1         290         3    115    70     NA P9   
 2 euro      1 1               1         295         2    102    60     30 P051 
 3 post      1 2               1         290         2    104    75     60 P051 
 4 euro      1 3               1         290         1    130    82     60 P050 
 5 euro      1 4               1         300         2    140    73     30 P038 
 6 euro      1 5               1         285         2     70    50     35 P050 
 7 pre       1 6               1         310         3     85    55     13 P038 
 8 euro      1 7               1         290         2    130    60     29 P028 
 9 pre       1 8               1         295         2    100    58     15 P038 
10 post      1 9               1         300         1    130    70     60 P052 
# ℹ 740 more rows
# ℹ 48 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Coffin &lt;dbl&gt;,
#   Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …</code></pre>
</div>
</div>
<p>or the <code>.by</code> argument in <code>summarise</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    mortuary_data,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_golden =</span> <span class="fu">mean</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_golden =</span> <span class="fu">median</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_golden =</span> <span class="fu">sd</span>(Golden_bead, <span class="at">na.rm =</span> T),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> Phase</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Phase     mean_golden median_golden sd_golden
  &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 pre              7.33             2     16.7 
2 euro             2.03             2      1.18
3 post             2.25             2      1.26
4 &lt;NA&gt;           NaN               NA     NA   
5 chi              1                1     NA   
6 disturbed      NaN               NA     NA   </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The values <code>NaN</code> (Not a Number) mean that there were no values in <code>Phase</code> that could be calculated.</p>
</div>
</div>
<p><code>Phase</code> is a factor variable with five levels, “chi”, “disturbed”, “euro”, “post”, “pre”, indicating the phase of occupation at the site. By adding it as a grouping variable through the <code>.by</code> argument (or <code>group_by</code> function) we tell <code>summarise()</code> that we want separate summary statistics for each level.</p>
<p>Remember how we used a <a href="../docs/05_visualising-data.html#categorical-variables">bar plot to get Phase counts</a>? We could also use <code>summarise()</code> with <code>n()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Phase         n
  &lt;chr&gt;     &lt;int&gt;
1 chi           4
2 disturbed     8
3 euro         44
4 post          5
5 pre          29
6 &lt;NA&gt;         35</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Phase)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div></div><p>This is equivalent to using the <code>count()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Phase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Phase         n
  &lt;chr&gt;     &lt;int&gt;
1 chi           4
2 disturbed     8
3 euro         44
4 post          5
5 pre          29
6 &lt;NA&gt;         35</code></pre>
</div>
</div>
</section>
<section id="across" class="level2">
<h2 class="anchored" data-anchor-id="across">across()</h2>
<p>If we want to perform the same operation on multiple variables, we can use the <code>across()</code> function. This will allow us to apply a function (or multiple functions) <code>across</code> multiple columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/2471e3f8-348e-470c-a162-3eea0606ff96_rw_1920.png?h=1caf8d5f3d25792fbaf296a1e62b670a" class="img-fluid figure-img" alt="A cute round fuzzy monster with fairy wings and a wand, with a party hat on reading “mean”, bouncing across the top of a data table applying the function to each column. Stylized text reads: “dplyr::across() - use within mutate() or summarize() to apply function(s) to a selection of columns!” An example shows the use within summarize: summarize(across(where(is.numeric), mean)). Learn more about dplyr::across()."></p>
<figcaption><a href="https://twitter.com/allison_horst">Artwork by <span class="citation" data-cites="allison_horst">@allison_horst</span>.</a></figcaption>
</figure>
</div>
<p>For example, we can <code>summarise</code> all our bead variables grouped by <code>Phase</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(Golden_bead, Glass_bead, IndoPacific_bead), </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Phase     Golden_bead Glass_bead IndoPacific_bead
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;
1 chi              1           NaN            NaN  
2 disturbed      NaN           NaN              1  
3 euro             2.03          1            188. 
4 post             2.25        NaN           1526  
5 pre              7.33          1            106  
6 &lt;NA&gt;           NaN           NaN              2.5</code></pre>
</div>
</div>
<p>The first argument in <code>across()</code> is the selection of columns to apply a function. The second argument is the function itself constructed as a lambda (<code>~ mean(.x, na.rm = T)</code>). The <code>.x</code> is a placeholder for the variables, so each of the selected variables will replace the <code>.x</code> in the mean function, producing a mean value for each of the variables supplied in the first argument of <code>across()</code>.</p>
<p>Typing individual variables can get very tedious very quickly. If the variables are adjacent we can use a colon <code>:</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        Agate_bead<span class="sc">:</span>Metal_piece, </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  Phase     Agate_bead Golden_bead Glass_bead IndoPacific_bead Glass_earring
  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;
1 chi           NaN           1           NaN            NaN             NaN
2 disturbed     NaN         NaN           NaN              1             NaN
3 euro            4.76        2.03          1            188.            NaN
4 post          NaN           2.25        NaN           1526             NaN
5 pre             3.92        7.33          1            106             NaN
6 &lt;NA&gt;           10         NaN           NaN              2.5             2
# ℹ 9 more variables: Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;dbl&gt;,
#   fish_shape_knit &lt;dbl&gt;, Metal_string &lt;dbl&gt;, Metal_piece &lt;dbl&gt;</code></pre>
</div>
</div>
<p>But we can rarely be so lucky. The method of selecting everything from <code>Agate_bead</code> to <code>Metal_piece</code> is also a little too error-prone. For example, did you notice that <code>Metal_piece</code> isn’t actually the last artefact column? And what if we had performed some sort of operation that rearranged columns? The risk of missing columns is quite high. Another way is to use selection helpers.</p>
</section>
<section id="selection-helpers" class="level2">
<h2 class="anchored" data-anchor-id="selection-helpers">Selection helpers</h2>
<p>If we want to select a range of variables in our data, or perform specific operations on multiple variables, there is a suite of functions known as ‘selection helpers’</p>
<ul>
<li><code>if_any()</code></li>
<li><code>if_all()</code></li>
<li><code>starts_with()</code></li>
<li><code>ends_with()</code></li>
<li><code>contains()</code></li>
<li><code>everything()</code></li>
</ul>
<p>You can see <code>?dplyr_tidy_select</code> for a more complete list.</p>
<p>If the variable names contain a specific string, we can use</p>
<ul>
<li><code>starts_with</code> if the string is a prefix</li>
<li><code>ends_with</code> if the string is a suffix</li>
<li><code>contains</code> if the string is anywhere in the variable name</li>
</ul>
<p>For example, if we wanted to select all bead variables, we could use both <code>contains("bead")</code> and <code>ends_with("bead")</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">contains</span>(<span class="st">"bead"</span>), </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Phase     Agate_bead Golden_bead Glass_bead IndoPacific_bead
  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;
1 chi           NaN           1           NaN            NaN  
2 disturbed     NaN         NaN           NaN              1  
3 euro            4.76        2.03          1            188. 
4 post          NaN           2.25        NaN           1526  
5 pre             3.92        7.33          1            106  
6 &lt;NA&gt;           10         NaN           NaN              2.5</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ends_with</span>(<span class="st">"bead"</span>), </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Phase     Agate_bead Golden_bead Glass_bead IndoPacific_bead
  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;
1 chi           NaN           1           NaN            NaN  
2 disturbed     NaN         NaN           NaN              1  
3 euro            4.76        2.03          1            188. 
4 post          NaN           2.25        NaN           1526  
5 pre             3.92        7.33          1            106  
6 &lt;NA&gt;           10         NaN           NaN              2.5</code></pre>
</div>
</div>
<p>It’s probably safer to use <code>contains("bead")</code>, just in case not all the variables involving bead end in the suffix ’_bead’. On the other hand you will need to be aware if any of the variables contain the string ‘bead’ somewhere in the variable name without being associated with beads (for example, the code would include a variable named beadle).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regular expression
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s also possible to construct a regular expression using <code>matches()</code>.</p>
</div>
</div>
<p>To check which variables we are actually selecting, we can combine our selection helper with <code>select()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"bead"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 4
   Agate_bead Golden_bead Glass_bead IndoPacific_bead
        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;
 1         NA          NA         NA               NA
 2         NA          NA         NA               NA
 3         NA          NA         NA               NA
 4         NA           5         NA               NA
 5         NA           2         NA               NA
 6         NA           2         NA                1
 7         NA          NA          1               NA
 8         NA           2          1               NA
 9          8          NA         NA                6
10         NA           2         NA             1526
# ℹ 115 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Select all columns with a <code>Metal</code> artefact. Then calculate the median for the counts grouped by <code>Phase</code>.</p>
<p><code>?dplyr_tidy_select</code> can help you find selection helpers.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">contains</span>(<span class="st">"Metal"</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">median</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  Phase  Big_Metal_ring Small_Metal_ring Wide_Metal_ring Metal_ring Metal_string
  &lt;chr&gt;           &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
1 chi                NA               NA              NA         NA           NA
2 distu…              2               NA              NA         NA            2
3 euro                2                2              NA          2            1
4 post                7                1               2          3            1
5 pre                 2                2               1          1            1
6 &lt;NA&gt;               NA               NA              NA         NA            1
# ℹ 2 more variables: Metal_piece &lt;dbl&gt;, Metal_plate &lt;dbl&gt;</code></pre>
</div>
</div>
<p><strong>Not all variables have ‘Metal’ as the first word, so <code>contains()</code> is the only way</strong></p>
<p>By default <code>contains()</code> is <strong>case INsensitive</strong>, so here we would also include any variables with “metal” in the name. To change this you can add <code>ignore.case = FALSE</code>.</p>
</div>
</div>
</div>
</div>
</div>
<p>To perform multiple operations on multiple columns, we can use a <strong>list</strong> inside <code>across()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ends_with</span>(<span class="st">"bead"</span>),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T), </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Phase     Agate_bead_mean Agate_bead_sd Golden_bead_mean Golden_bead_sd
  &lt;chr&gt;               &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
1 chi                NaN            NA                1             NA   
2 disturbed          NaN            NA              NaN             NA   
3 euro                 4.76          4.05             2.03           1.18
4 post               NaN            NA                2.25           1.26
5 pre                  3.92          2.35             7.33          16.7 
6 &lt;NA&gt;                10            13.9            NaN             NA   
# ℹ 4 more variables: Glass_bead_mean &lt;dbl&gt;, Glass_bead_sd &lt;dbl&gt;,
#   IndoPacific_bead_mean &lt;dbl&gt;, IndoPacific_bead_sd &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Lists are a type of R object that can contain all other types of R objects.</p>
<p>For example, here is a list that contains multiple types of objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a_vector"</span> <span class="ot">=</span> mortuary_data<span class="sc">$</span>Width,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a_data_frame"</span> <span class="ot">=</span> mortuary_data,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a_function"</span> <span class="ot">=</span> mean,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"etc"</span> <span class="ot">=</span> <span class="st">"etc"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a_vector
  [1] 70 60 75 82 73 50 55 60 58 70 60 NA 60 45 60 70 NA 60 47 70 55 70 45 70 80
 [26] 45 75 70 73 58 45 60 45 60 57 45 55 65 45 75 50 50 50 70 NA 70 75 60 70 56
 [51] NA 70 53 56 35 40 60 70 90 40 65 65 55 45 65 60 NA 60 65 70 75 40 60 40 45
 [76] 70 NA 65 55 50 60 70 45 NA NA NA 83 60 60 50 65 NA 50 60 70 85 55 70 NA 60
[101] 53 60 55 70 47 60 40 55 40 20 50 25 46 78 55 55 60 45 NA NA 60 35 75 60 40

$a_data_frame
# A tibble: 125 × 55
   Layer ID    Burial_axis Degree_axis Condition Length Width Height Pit  
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     1 0               1         290         3    115    70     NA P9   
 2     1 1               1         295         2    102    60     30 P051 
 3     1 2               1         290         2    104    75     60 P051 
 4     1 3               1         290         1    130    82     60 P050 
 5     1 4               1         300         2    140    73     30 P038 
 6     1 5               1         285         2     70    50     35 P050 
 7     1 6               1         310         3     85    55     13 P038 
 8     1 7               1         290         2    130    60     29 P028 
 9     1 8               1         295         2    100    58     15 P038 
10     1 9               1         300         1    130    70     60 P052 
# ℹ 115 more rows
# ℹ 46 more variables: sampled &lt;chr&gt;, start_layer &lt;dbl&gt;, start_depth &lt;dbl&gt;,
#   end_depth &lt;dbl&gt;, start_depth_sure &lt;chr&gt;, old_layer &lt;dbl&gt;, Phase &lt;chr&gt;,
#   Coffin &lt;dbl&gt;, Straw_mat &lt;dbl&gt;, Gender &lt;dbl&gt;, Age &lt;chr&gt;, Agate_bead &lt;dbl&gt;,
#   Golden_bead &lt;dbl&gt;, Glass_bead &lt;dbl&gt;, IndoPacific_bead &lt;dbl&gt;,
#   Glass_earring &lt;dbl&gt;, Big_Metal_ring &lt;dbl&gt;, Small_Metal_ring &lt;dbl&gt;,
#   Wide_Metal_ring &lt;dbl&gt;, Metal_ring &lt;dbl&gt;, Bell &lt;dbl&gt;, Knit &lt;lgl&gt;, …

$a_function
function (x, ...) 
UseMethod("mean")
&lt;bytecode: 0x55e81bda31a0&gt;
&lt;environment: namespace:base&gt;

$etc
[1] "etc"</code></pre>
</div>
</div>
<p>Even with all the selection helpers, there’s really no convenient way to calculate the mean and standard deviation of artefact counts across all artefacts. We still need to use the range of columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        Agate_bead<span class="sc">:</span>Kendi_mouth,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T), </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 71
  Phase     Agate_bead_mean Agate_bead_sd Golden_bead_mean Golden_bead_sd
  &lt;chr&gt;               &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
1 chi                NaN            NA                1             NA   
2 disturbed          NaN            NA              NaN             NA   
3 euro                 4.76          4.05             2.03           1.18
4 post               NaN            NA                2.25           1.26
5 pre                  3.92          2.35             7.33          16.7 
6 &lt;NA&gt;                10            13.9            NaN             NA   
# ℹ 66 more variables: Glass_bead_mean &lt;dbl&gt;, Glass_bead_sd &lt;dbl&gt;,
#   IndoPacific_bead_mean &lt;dbl&gt;, IndoPacific_bead_sd &lt;dbl&gt;,
#   Glass_earring_mean &lt;dbl&gt;, Glass_earring_sd &lt;dbl&gt;,
#   Big_Metal_ring_mean &lt;dbl&gt;, Big_Metal_ring_sd &lt;dbl&gt;,
#   Small_Metal_ring_mean &lt;dbl&gt;, Small_Metal_ring_sd &lt;dbl&gt;,
#   Wide_Metal_ring_mean &lt;dbl&gt;, Wide_Metal_ring_sd &lt;dbl&gt;,
#   Metal_ring_mean &lt;dbl&gt;, Metal_ring_sd &lt;dbl&gt;, Bell_mean &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Now try to think of a way to create a bar plot that has all the bead-related variables.</p>
<p>I haven’t included a solution because, to be honest, I’m not sure how to go about that. At least not with the data in their current form.</p>
<p>The selection helpers make our life easier, but having the artefact names as columns is making the visualisation and transformation of artefacts unnecessarily complicated.</p>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">Tidy data</h2>
<blockquote class="blockquote">
<p>“Tidy datasets are all alike, but every messy dataset is messy in its own way.””</p>
<p>– Hadley Wickham</p>
</blockquote>
<p>The concept of tidy data and an early iteration of some tidyverse packages were introduced by Hadley Wickham in a <a href="https://doi.org/10.18637/jss.v059.i10">2014 paper</a>. Tidy data is now one of the core philosophies of data science. If data structures are consistent, it’s easier to learn and create a unified set of tools for working with the data (such as the tidyverse packages).</p>
<p>A tidy dataset has the following structure:</p>
<ul>
<li>Each variable is a column; for example, <code>Phase</code> of occupation</li>
<li>Each observation is a row</li>
<li>Each value is a cell; each cell has a single value</li>
</ul>
<p><img src="../images/tidy-data2.jpg" class="img-fluid" alt="On the left is a happy cute fuzzy monster holding a rectangular data frame with a tool that fits the data frame shape. On the workbench behind the monster are other data frames of similar rectangular shape, and neatly arranged tools that also look like they would fit those data frames. The workbench looks uncluttered and tidy. The text above the tidy workbench reads &quot;When working with tidy data, we can use the same tools in similar ways for different datasets…&quot; On the right is a cute monster looking very frustrated, using duct tape and other tools to haphazardly tie data tables together, each in a different way. The monster is in front of a messy, cluttered workbench. The text above the frustrated monster reads &quot;...but working with untidy data often means reinventing the wheel with one-time approaches that are hard to iterate or reuse.&quot; "></p>
<p>In our dataset we have each burial in a row, i.e., an observation. This is most likely because it is the easiest way to enter the data into the spreadsheet, but it arguably violates the principle of each row being an observation. And it would be much more useful if we had a column with artefact names where we could <code>filter</code> or <code>group_by</code> artefact, which we could then <code>summarise</code>.</p>
<p>Enter <code>pivot_longer()</code>.</p>
</section>
<section id="pivoting" class="level2">
<h2 class="anchored" data-anchor-id="pivoting">Pivoting</h2>
<section id="pivot_longer" class="level3">
<h3 class="anchored" data-anchor-id="pivot_longer"><code>pivot_longer()</code></h3>
<p>If we lengthen the data by creating a column that has the name of artefact and another column that has the count, we might have an easier time working with them.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZ3dic3QyN2g5dzNjbTlheHhpaGwxdXhqcnBjcmx4bDdhaWVoZGU3aCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/oCjCwnuLpiWbfMb1UA/giphy.gif" class="img-fluid figure-img" alt="A GIF with a scene from the TV show Friends where Ross is trying to carry a couch up the stairs and yelling 'Pivot' to get around the corner."></p>
<figcaption>GIPHY</figcaption>
</figure>
</div>
<p>Because we want to lengthen the data we need the function <code>pivot_longer()</code> from {tidyr}. The main argument we need is <code>cols</code> which we use to specify which column(s) we are lengthening. We can start with two artefacts to visualise the process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="ot">&lt;-</span> mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Phase, Agate_bead, Golden_bead) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Agate_bead<span class="sc">:</span>Golden_bead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check out the <code>Golden_bead</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>artefact_long<span class="sc">$</span>Golden_bead</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `Golden_bead`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>The column <code>Golden_bead</code> no longer exists. Instead we have two new columns, <code>name</code> and <code>value</code> which contain the name of our artefact and the count of that artefact for each burial, respectively. We also have a data frame with twice as many rows as our original, because now each row is an artefact, not a burial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>artefact_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 250 × 4
   ID    Phase name        value
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
 1 0     pre   Agate_bead     NA
 2 0     pre   Golden_bead    NA
 3 1     euro  Agate_bead     NA
 4 1     euro  Golden_bead    NA
 5 2     post  Agate_bead     NA
 6 2     post  Golden_bead    NA
 7 3     euro  Agate_bead     NA
 8 3     euro  Golden_bead     5
 9 4     euro  Agate_bead     NA
10 4     euro  Golden_bead     2
# ℹ 240 more rows</code></pre>
</div>
</div>
<p>Now we can apply it to all the artefacts. And to make things easier for ourselves we can also use the <code>names_to</code> and <code>values_to</code> arguments to define the names of our new variables instead of using the defaults <code>name</code> and <code>value</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="ot">&lt;-</span> mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    Agate_bead<span class="sc">:</span>Metal_piece, <span class="co"># yes, we still need from x to y, but only once.</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"artefact"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have one row per artefact, the data frame is much longer, and some of the variables are repeated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(artefact_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1750   43</code></pre>
</div>
</div>
<p>This allows us to use <code>summarise</code> artefact counts without relying on across.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(artefact) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">median</span>(count, <span class="at">na.rm =</span> T),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 3
   artefact          mean      sd
   &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
 1 Agate_bead         3.5   5.07 
 2 Bell               1.5   0.816
 3 Big_Metal_ring     2     1.57 
 4 Glass_bead         1     0    
 5 Glass_earring      2    NA    
 6 Golden_bead        2     8.62 
 7 IndoPacific_bead   5   553.   
 8 Knit              NA    NA    
 9 Metal_piece        1     0    
10 Metal_ring         2     1.30 
11 Metal_string       1     1.07 
12 Small_Metal_ring   2     2.42 
13 Wide_Metal_ring    1     0.408
14 fish_shape_knit    1     0    </code></pre>
</div>
</div>
<p>This is the same as we before, but with simpler code and a more readable output.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(artefact, Phase) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">median</span>(count, <span class="at">na.rm =</span> T),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'artefact'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 4
# Groups:   artefact [14]
   artefact   Phase      mean     sd
   &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1 Agate_bead chi          NA NA    
 2 Agate_bead disturbed    NA NA    
 3 Agate_bead euro          3  4.05 
 4 Agate_bead post         NA NA    
 5 Agate_bead pre           4  2.35 
 6 Agate_bead &lt;NA&gt;          2 13.9  
 7 Bell       chi          NA NA    
 8 Bell       disturbed    NA NA    
 9 Bell       euro          1  0.548
10 Bell       post         NA NA    
# ℹ 74 more rows</code></pre>
</div>
</div>
</div><div class="column" style="width:4%;">

</div><div class="column" style="width:48%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>mortuary_data <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>        Agate_bead<span class="sc">:</span>Kendi_mouth,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T), </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm =</span> T)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 71
  Phase     Agate_bead_mean Agate_bead_sd Golden_bead_mean Golden_bead_sd
  &lt;chr&gt;               &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
1 chi                NaN            NA                1             NA   
2 disturbed          NaN            NA              NaN             NA   
3 euro                 4.76          4.05             2.03           1.18
4 post               NaN            NA                2.25           1.26
5 pre                  3.92          2.35             7.33          16.7 
6 &lt;NA&gt;                10            13.9            NaN             NA   
# ℹ 66 more variables: Glass_bead_mean &lt;dbl&gt;, Glass_bead_sd &lt;dbl&gt;,
#   IndoPacific_bead_mean &lt;dbl&gt;, IndoPacific_bead_sd &lt;dbl&gt;,
#   Glass_earring_mean &lt;dbl&gt;, Glass_earring_sd &lt;dbl&gt;,
#   Big_Metal_ring_mean &lt;dbl&gt;, Big_Metal_ring_sd &lt;dbl&gt;,
#   Small_Metal_ring_mean &lt;dbl&gt;, Small_Metal_ring_sd &lt;dbl&gt;,
#   Wide_Metal_ring_mean &lt;dbl&gt;, Wide_Metal_ring_sd &lt;dbl&gt;,
#   Metal_ring_mean &lt;dbl&gt;, Metal_ring_sd &lt;dbl&gt;, Bell_mean &lt;dbl&gt;, …</code></pre>
</div>
</div>
</div>
</div>
<p>Now let’s try visualising the artefacts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> artefact, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1521 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Since <code>IndoPacific_bead</code> is so dominant, we could remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artefact <span class="sc">!=</span> <span class="st">"IndoPacific_bead"</span>) <span class="sc">|&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> artefact, <span class="at">y =</span> count, <span class="at">fill =</span> Phase)) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1433 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The large difference in absolute counts still makes it difficult to read the plot. It could make more sense to calculate the porportion of each artefact within each <code>Phase</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>percent_artefacts <span class="ot">&lt;-</span> artefact_long <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase, artefact) <span class="sc">|&gt;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">sum</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> (n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Phase'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a> percent_artefacts <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Phase, <span class="at">y =</span> percent, <span class="at">fill =</span> artefact)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To break down the above code. We are grouping by <code>Phase</code> and <code>artefact</code> because we want to calculate how many of each <code>artefact</code> are in a given <code>Phase</code>. Then we use <code>sum</code> within <code>summarise()</code> to do the actual calculation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase, artefact) <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">sum</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Phase'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 3
# Groups:   Phase [6]
   Phase artefact             n
   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
 1 chi   Agate_bead           0
 2 chi   Bell                 0
 3 chi   Big_Metal_ring       0
 4 chi   Glass_bead           0
 5 chi   Glass_earring        0
 6 chi   Golden_bead          1
 7 chi   IndoPacific_bead     0
 8 chi   Knit                 0
 9 chi   Metal_piece          0
10 chi   Metal_ring           0
# ℹ 74 more rows</code></pre>
</div>
</div>
<p>Then we want to calculate the percentage each artefact makes up of the total count of artefacts within each Phase, so this time we only use <code>Phase</code> as a group and then calculate the percentage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase, artefact) <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">sum</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Phase) <span class="sc">|&gt;</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> (n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Phase'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 4
# Groups:   Phase [6]
   Phase artefact             n percent
   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
 1 chi   Agate_bead           0       0
 2 chi   Bell                 0       0
 3 chi   Big_Metal_ring       0       0
 4 chi   Glass_bead           0       0
 5 chi   Glass_earring        0       0
 6 chi   Golden_bead          1     100
 7 chi   IndoPacific_bead     0       0
 8 chi   Knit                 0       0
 9 chi   Metal_piece          0       0
10 chi   Metal_ring           0       0
# ℹ 74 more rows</code></pre>
</div>
</div>
<p>This gives us the variables we need to produce the plot.</p>
<p>Another solution is to use panels in our plot, where each <code>artefact</code> gets it’s own mini plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Phase, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> artefact) <span class="co"># a panel per artefact</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1521 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Each panel will have the same y-axis limits, which makes it difficult to see anything other than <code>IndoPacific_bead</code>. Instead we can give each panel its own limits based on the values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Phase, <span class="at">y =</span> count, <span class="at">fill =</span> Phase)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> artefact, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1521 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/artefact-counts-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We could also select specific artefacts we would like to focus on. To do this we will need to <code>filter</code> the <code>artefact</code> column. Since <code>filter</code> is not a selecting function, we cannot use selection helpers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">contains</span>(<span class="st">"metal"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Error in filter(artefact_long, contains("bead")) : 
  ℹ In argument: `contains("bead")`.
Caused by error:
! `contains()` must be used within a *selecting* function.
ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-selection-context.html&gt; for
  details.</code></pre>
</div>
</div>
<p>Instead we need to rely on a condition that evaluates to <code>TRUE</code> or <code>FALSE</code>. Rather than using <code>artefact == "name of artefact"</code> multiple times, we can use functions from the <span class="pkg">stringr</span> package to detect patterns. Specifically <code>str_detect()</code> allows us to identify a string in a variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>artefact_long <span class="sc">|&gt;</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(artefact, <span class="st">"bead"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> artefact, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 382 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_transforming-data_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>str_detect()</code>, as the name implies, detects whether the string ‘bead’ exists in the <code>artefact</code> variable, and returns <code>TRUE</code> if it does, and <code>FALSE</code> if it does not. Exactly what we need for the <code>filter()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(artefact_long<span class="sc">$</span>artefact, <span class="st">"bead"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="co"># limit the output to 100 values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [13] FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
 [25] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
 [37] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
 [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
 [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
 [73]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [85]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [97] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
</div>
<p>The long format of the data also makes it easier to <code>summarise()</code> the counts of each <code>artefact</code> by <code>Phase</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(artefact_long,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">count =</span> <span class="fu">sum</span>(count, <span class="at">na.rm =</span> T),</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> <span class="fu">c</span>(Phase, artefact))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 3
   Phase artefact         count
   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
 1 pre   Agate_bead          47
 2 pre   Golden_bead         88
 3 pre   Glass_bead           1
 4 pre   IndoPacific_bead  1166
 5 pre   Glass_earring        0
 6 pre   Big_Metal_ring      39
 7 pre   Small_Metal_ring    36
 8 pre   Wide_Metal_ring      5
 9 pre   Metal_ring           1
10 pre   Bell                 0
# ℹ 74 more rows</code></pre>
</div>
</div>
<p>And we can create a new data frame with the total artefact count for each burial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>total_artefact_count <span class="ot">&lt;-</span> artefact_long <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Phase, Age, Gender) <span class="sc">|&gt;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_count =</span> <span class="fu">sum</span>(count, <span class="at">na.rm =</span> T)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ID', 'Phase', 'Age'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>total_artefact_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 5
   ID    Phase Age   Gender total_count
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;       &lt;dbl&gt;
 1 0     pre   &lt;NA&gt;      NA           3
 2 1     euro  4         NA           0
 3 100   euro  2         NA           3
 4 101   pre   5          1           1
 5 102   pre   4          3           9
 6 103   pre   4         NA           1
 7 104   pre   2         NA           2
 8 105   &lt;NA&gt;  &lt;NA&gt;       2           0
 9 106   &lt;NA&gt;  &lt;NA&gt;      NA           0
10 107   euro  7          4          19
# ℹ 115 more rows</code></pre>
</div>
</div>
<p>And export it as a <em>.csv</em> file to our <em>data/</em> folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(total_artefact_count, <span class="fu">here</span>(<span class="st">"data/total-artefact-count.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pivot_wider" class="level3">
<h3 class="anchored" data-anchor-id="pivot_wider"><code>pivot_wider()</code></h3>
<p>The complement to <code>pivot_longer()</code> is <code>pivot_wider()</code>. We could use it to go back to the original data frame. Instead of moving existing column names to a column, and existing values to another column, we want to move names <strong>from</strong> a column and values <strong>from</strong> another column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>artefact_wide <span class="ot">&lt;-</span> artefact_long <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> artefact, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we are back to where we started.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(artefact_wide) <span class="sc">==</span> <span class="fu">dim</span>(mortuary_data) <span class="co"># we are testing if this statement is TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/rchaeology\.github\.io\/RchaeoStats\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../docs/05_visualising-data.html" class="pagination-link" aria-label="05 - Visualising Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">05 - Visualising Data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../docs/08_communicating-results.html" class="pagination-link" aria-label="08 - Communicating Results">
        <span class="nav-page-text">08 - Communicating Results</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Initial development was generously funded by <a href="https://www.dainst.org/">Deutsches Archäologisches Institut</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://doi.org/10.5281/zenodo.13983364"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.13983364.svg" class="img-fluid"></a> <a href="https://github.com/rchaeology/RchaeoStats"><i class="fa-brands fa-github" aria-label="github"></i></a></p>
</div>
  </div>
</footer>




</body></html>